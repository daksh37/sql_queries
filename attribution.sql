create table attribution_18_19_01 (like pd_attribution_0907);

insert into attribution_18_19_01(
select * from pd_attribution_0907 where prid='1' and extract (year from atrdt)='2019' and atrl='Payer' and z_elg_flg in ('1','2','3','4')
);

insert into attribution_18_19_01(acoid,
acon,
atrdt,
atred,
atrl,
atrsd,
bedpa,
bedpb,
bfmdst,
bfsdcd,
byind,
df,
dob,
dod,
eltp,
empi,
fn,
gn,
hicno,
id,
idt,
ingdt,
ingno,
inpr,
inptp,
ln,
mn,
node_id,
old_empi,
orec,
orgid,
orgn,
orgtin,
partition_number,
pci,
pcpatrm,
pcpn,
pcpnpi,
pcps,
pcpsc,
pct,
pipeline_id,
pipid,
plid,
plnm,
pltp,
prid,
prnm,
psa1,
psa2,
pst,
pthcno,
pz,
race,
rcdt,
rid,
rn,
sfn,
sid,
slid,
sln,
slnpi,
sno,
sstp,
st,
stid,
stn,
timestamp,
z_acrgcd,
z_acrgn,
z_active_flg,
z_elg_flg,
z_qtr) select acoid,
acon,
atrdt,
atred,
atrl,
atrsd,
bedpa,
bedpb,
bfmdst,
bfsdcd,
byind,
df,
dob,
dod,
eltp,
empi,
fn,
gn,
hicno,
id,
idt,
ingdt,
ingno,
inpr,
inptp,
ln,
mn,
node_id,
old_empi,
orec,
orgid,
orgn,
orgtin,
partition_number,
pci,
pcpatrm,
pcpn,
pcpnpi,
pcps,
pcpsc,
pct,
pipeline_id,
pipid,
plid,
plnm,
pltp,
prid,
prnm,
psa1,
psa2,
pst,
pthcno,
pz,
race,
rcdt,
rid,
rn,
sfn,
sid,
slid,
sln,
slnpi,
sno,
sstp,
st,
stid,
stn,
timestamp,
z_acrgcd,
z_acrgn,
z_active_flg,
z_elg_flg,
z_qtr from attribution_jdbc_attribution where prid='1' and extract (year from atrdt)='2018' and atrl='Payer' and z_elg_flg<>'0' ;

-- remove the N ones///////////
delete from attribution_18_19_01 where z_active_flg ='N';
